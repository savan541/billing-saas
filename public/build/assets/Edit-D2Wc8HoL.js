import{u as k,r as u,j as e,H as E,L as g}from"./app-2KutEqL2.js";import{A as P}from"./AuthenticatedLayout-DfCoeJWv.js";import{P as _}from"./PrimaryButton-Duk-7vCM.js";import{S as f,D as B}from"./DangerButton-M8wQaS-D.js";import{T as m}from"./TextInput-BW4MlzIu.js";import{I as c}from"./InputLabel-458NYyOD.js";import{I as o}from"./InputError-CJ8HMZoM.js";import"./ApplicationLogo-DjR4Xp_r.js";import"./transition-BAKxU7HE.js";function M({invoice:t,clients:v}){const{data:d,setData:r,put:N,processing:y,errors:l,reset:L}=k({client_id:t.client_id.toString(),number:t.number,status:t.status,issued_at:t.issued_at,due_at:t.due_at,items:t.items.map(s=>({description:s.description,quantity:s.quantity.toString(),unit_price:s.unit_price.toString()}))}),[w,I]=u.useState(t.subtotal),[F,S]=u.useState(t.tax),[C,D]=u.useState(t.total),j=u.useCallback(()=>{const s=d.items.reduce((n,x)=>{const h=parseFloat(x.quantity)||0,b=parseFloat(x.unit_price)||0;return n+h*b},0),a=s*.1,i=s+a;I(s),S(a),D(i)},[d.items]);u.useEffect(()=>{j()},[j]);const q=()=>{r("items",[...d.items,{description:"",quantity:"1",unit_price:"0"}])},A=s=>{const a=d.items.filter((i,n)=>n!==s);r("items",a)},p=(s,a,i)=>{const n=[...d.items];n[s][a]=i,r("items",n)},$=s=>{s.preventDefault();const a=d.items.reduce((x,h)=>{const b=parseFloat(h.quantity)||0,T=parseFloat(h.unit_price)||0;return x+b*T},0),i=a*.1,n=a+i;r("subtotal",a),r("tax",i),r("total",n),N(route("invoices.update",t.id))};return e.jsxs(P,{children:[e.jsx(E,{title:`Edit Invoice ${t.number}`}),e.jsxs("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(g,{href:route("invoices.index"),children:e.jsx(f,{children:"â† Back to Invoices"})}),e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900",children:["Edit Invoice ",t.number]})]}),!t.can_be_modified&&e.jsx("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-yellow-800",children:"This invoice cannot be modified because it's already paid."})}),e.jsx("form",{onSubmit:$,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:[e.jsx("div",{className:"p-6 bg-white border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Invoice Details"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"client_id",children:"Client"}),e.jsxs("select",{id:"client_id",value:d.client_id,onChange:s=>r("client_id",s.target.value),disabled:!t.can_be_modified,className:`mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm ${l.client_id?"border-red-500":""} ${t.can_be_modified?"":"bg-gray-100"}`,children:[e.jsx("option",{value:"",children:"Select a client"}),v.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx(o,{message:l.client_id,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"number",children:"Invoice Number"}),e.jsx(m,{id:"number",value:d.number,onChange:s=>r("number",s.target.value),disabled:!t.can_be_modified,className:l.number?"border-red-500":""}),e.jsx(o,{message:l.number,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"issued_at",children:"Issue Date"}),e.jsx(m,{id:"issued_at",type:"date",value:d.issued_at,onChange:s=>r("issued_at",s.target.value),disabled:!t.can_be_modified,className:l.issued_at?"border-red-500":""}),e.jsx(o,{message:l.issued_at,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"due_at",children:"Due Date"}),e.jsx(m,{id:"due_at",type:"date",value:d.due_at,onChange:s=>r("due_at",s.target.value),disabled:!t.can_be_modified,className:l.due_at?"border-red-500":""}),e.jsx(o,{message:l.due_at,className:"mt-2"})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"status",children:"Status"}),e.jsxs("select",{id:"status",value:d.status,onChange:s=>r("status",s.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"overdue",children:"Overdue"})]})]})]})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:[e.jsx("div",{className:"p-6 bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Invoice Items"}),e.jsx(_,{type:"button",onClick:q,disabled:!t.can_be_modified,children:"+ Add Item"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx(o,{message:l.items,className:"mb-4"}),e.jsx("div",{className:"space-y-4",children:d.items.map((s,a)=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[e.jsxs("div",{className:"col-span-6",children:[e.jsx(c,{children:"Description"}),e.jsx(m,{value:s.description,onChange:i=>p(a,"description",i.target.value),placeholder:"Item description",disabled:!t.can_be_modified}),e.jsx(o,{message:l[`items.${a}.description`],className:"mt-2"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(c,{children:"Quantity"}),e.jsx(m,{type:"number",step:"0.01",value:s.quantity,onChange:i=>p(a,"quantity",i.target.value),placeholder:"1",disabled:!t.can_be_modified}),e.jsx(o,{message:l[`items.${a}.quantity`],className:"mt-2"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(c,{children:"Unit Price"}),e.jsx(m,{type:"number",step:"0.01",value:s.unit_price,onChange:i=>p(a,"unit_price",i.target.value),placeholder:"0.00",disabled:!t.can_be_modified}),e.jsx(o,{message:l[`items.${a}.unit_price`],className:"mt-2"})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(B,{type:"button",onClick:()=>A(a),disabled:d.items.length===1||!t.can_be_modified,children:"Delete"})})]})},a))})]})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:[e.jsx("div",{className:"p-6 bg-white border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Summary"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["$",parseFloat(w).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax (10%):"}),e.jsxs("span",{children:["$",parseFloat(F).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg border-t pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["$",parseFloat(C).toFixed(2)]})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{type:"submit",disabled:y||!t.can_be_modified,className:"flex-1",children:"Update Invoice"}),e.jsx(g,{href:route("invoices.show",t.id),children:e.jsx(f,{type:"button",children:"Cancel"})})]})]})]})})]})})]})]})}export{M as default};
