import{u as k,r as m,j as e,H as P,L as g}from"./app-2KutEqL2.js";import{A as B}from"./AuthenticatedLayout-DfCoeJWv.js";import{P as v}from"./PrimaryButton-Duk-7vCM.js";import{S as b,D as E}from"./DangerButton-M8wQaS-D.js";import{T as o}from"./TextInput-BW4MlzIu.js";import{I as d}from"./InputLabel-458NYyOD.js";import{I as c}from"./InputError-CJ8HMZoM.js";import"./ApplicationLogo-DjR4Xp_r.js";import"./transition-BAKxU7HE.js";function z({clients:N}){const{data:a,setData:l,post:f,processing:y,errors:r,reset:_}=k({client_id:"",number:`INV-${new Date().getFullYear()}-${String(Math.floor(Math.random()*1e4)).padStart(4,"0")}`,status:"draft",issued_at:new Date().toISOString().split("T")[0],due_at:new Date(Date.now()+2592e6).toISOString().split("T")[0],items:[{description:"",quantity:"1",unit_price:"0"}]}),[w,I]=m.useState(0),[S,C]=m.useState(0),[F,D]=m.useState(0),j=m.useCallback(()=>{const s=a.items.reduce((n,u)=>{const x=parseFloat(u.quantity)||0,p=parseFloat(u.unit_price)||0;return n+x*p},0),t=s*.1,i=s+t;I(s),C(t),D(i)},[a.items]);m.useEffect(()=>{j()},[j]);const q=()=>{l("items",[...a.items,{description:"",quantity:"1",unit_price:"0"}])},A=s=>{const t=a.items.filter((i,n)=>n!==s);l("items",t)},h=(s,t,i)=>{const n=[...a.items];n[s][t]=i,l("items",n)},T=s=>{s.preventDefault();const t=a.items.reduce((u,x)=>{const p=parseFloat(x.quantity)||0,$=parseFloat(x.unit_price)||0;return u+p*$},0),i=t*.1,n=t+i;l("subtotal",t),l("tax",i),l("total",n),f(route("invoices.store"),{onSuccess:()=>_()})};return e.jsxs(B,{children:[e.jsx(P,{title:"Create Invoice"}),e.jsxs("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(g,{href:route("invoices.index"),children:e.jsx(b,{children:"â† Back to Invoices"})}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Create Invoice"})]}),e.jsx("form",{onSubmit:T,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:[e.jsx("div",{className:"p-6 bg-white border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Invoice Details"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"client_id",children:"Client"}),e.jsxs("select",{id:"client_id",value:a.client_id,onChange:s=>l("client_id",s.target.value),className:`mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm ${r.client_id?"border-red-500":""}`,children:[e.jsx("option",{value:"",children:"Select a client"}),N.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx(c,{message:r.client_id,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"number",children:"Invoice Number"}),e.jsx(o,{id:"number",value:a.number,onChange:s=>l("number",s.target.value),className:r.client_id?"border-red-500":""}),e.jsx(c,{message:r.number,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"issued_at",children:"Issue Date"}),e.jsx(o,{id:"issued_at",type:"date",value:a.issued_at,onChange:s=>l("issued_at",s.target.value),className:r.issued_at?"border-red-500":""}),e.jsx(c,{message:r.issued_at,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"due_at",children:"Due Date"}),e.jsx(o,{id:"due_at",type:"date",value:a.due_at,onChange:s=>l("due_at",s.target.value),className:r.due_at?"border-red-500":""}),e.jsx(c,{message:r.due_at,className:"mt-2"})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"status",children:"Status"}),e.jsxs("select",{id:"status",value:a.status,onChange:s=>l("status",s.target.value),className:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"overdue",children:"Overdue"})]})]})]})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:[e.jsx("div",{className:"p-6 bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Invoice Items"}),e.jsx(v,{type:"button",onClick:q,children:"+ Add Item"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx(c,{message:r.items,className:"mb-4"}),e.jsx("div",{className:"space-y-4",children:a.items.map((s,t)=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[e.jsxs("div",{className:"col-span-6",children:[e.jsx(d,{children:"Description"}),e.jsx(o,{value:s.description,onChange:i=>h(t,"description",i.target.value),placeholder:"Item description"}),e.jsx(c,{message:r[`items.${t}.description`],className:"mt-2"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(d,{children:"Quantity"}),e.jsx(o,{type:"number",step:"0.01",value:s.quantity,onChange:i=>h(t,"quantity",i.target.value),placeholder:"1"}),e.jsx(c,{message:r[`items.${t}.quantity`],className:"mt-2"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(d,{children:"Unit Price"}),e.jsx(o,{type:"number",step:"0.01",value:s.unit_price,onChange:i=>h(t,"unit_price",i.target.value),placeholder:"0.00"}),e.jsx(c,{message:r[`items.${t}.unit_price`],className:"mt-2"})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(E,{type:"button",onClick:()=>A(t),disabled:a.items.length===1,children:"Delete"})})]})},t))})]})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:[e.jsx("div",{className:"p-6 bg-white border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Summary"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["$",parseFloat(w).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax (10%):"}),e.jsxs("span",{children:["$",parseFloat(S).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg border-t pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["$",parseFloat(F).toFixed(2)]})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{type:"submit",disabled:y,className:"flex-1",children:"Create Invoice"}),e.jsx(g,{href:route("invoices.index"),children:e.jsx(b,{type:"button",children:"Cancel"})})]})]})]})})]})})]})]})}export{z as default};
